<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CEO is an admin dashboard for independent artists focused on pay transparency and negotiation leverage.">
    <meta name="theme-color" content="#f5f0e8" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#0c0c0e" media="(prefers-color-scheme: dark)">
    <title>CEO — Artist Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        button, input, select, textarea { font-family: inherit; }

        :root {
            --bg-primary: #f5f0e8;
            --bg-secondary: #fff;
            --bg-tertiary: #ebe5db;
            --text-primary: #1a1a1a;
            --text-secondary: #666;
            --text-tertiary: #999;
            --border: #e0dbd3;
            --accent: #2d5a5a;
            --accent-light: rgba(45, 90, 90, 0.1);
            --positive: #2d6a4f;
            --positive-light: rgba(45, 106, 79, 0.08);
            --negative: #8b3a3a;
            --negative-light: rgba(139, 58, 58, 0.08);
        }

        [data-theme="dark"] {
            --bg-primary: #0c0c0e;
            --bg-secondary: #141416;
            --bg-tertiary: #1c1c1f;
            --text-primary: #e8e8e8;
            --text-secondary: #888;
            --text-tertiary: #555;
            --border: #2a2a2e;
            --accent: #5a9a9a;
            --accent-light: rgba(90, 154, 154, 0.12);
            --positive: #7a9b82;
            --positive-light: rgba(122, 155, 130, 0.1);
            --negative: #b07070;
            --negative-light: rgba(176, 112, 112, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            font-size: 15px;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .dashboard, .card, .stat-card, .btn, .nav-item, .nudge-item, .tool-card, .deal-card, .result-card, .cta-card, .contract-input, .choice-card, .filter-btn, .actions-menu, .nudges-collapsed {
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .dashboard { max-width: 1200px; margin: 0 auto; padding: 32px 24px; }

        .header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 32px; padding-bottom: 24px; border-bottom: 1px solid var(--border);
        }
        .header-left { display: flex; align-items: center; gap: 32px; }
        .logo { font-family: 'Instrument Serif', Georgia, serif; font-size: 28px; cursor: pointer; }
        .header-nav { display: flex; gap: 6px; flex-wrap: wrap; }
        .nav-item {
            font-size: 14px; padding: 8px 14px; border-radius: 8px; color: var(--text-secondary);
            cursor: pointer; border: none; background: none; transition: all 0.15s; font-weight: 500;
        }
        .nav-item:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .nav-item.active { background: var(--text-primary); color: var(--bg-primary); }
        .header-actions { display: flex; gap: 8px; align-items: center; }
        .theme-toggle {
            width: 32px; height: 32px; border-radius: 8px; border: 1px solid var(--border);
            background: var(--bg-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .theme-toggle:hover { background: var(--bg-tertiary); }
        .theme-toggle svg { width: 16px; height: 16px; color: var(--text-secondary); }

        .actions-dropdown { position: relative; }
        .actions-btn {
            display: flex; align-items: center; gap: 6px;
            padding: 6px 12px; border-radius: 8px; border: 1px solid var(--border);
            background: var(--bg-secondary); cursor: pointer; font-size: 14px;
            font-weight: 500; color: var(--text-secondary);
        }
        .actions-btn:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .actions-btn svg { width: 14px; height: 14px; }
        .actions-menu {
            position: absolute; top: calc(100% + 8px); right: 0;
            min-width: 200px; background: var(--bg-primary);
            border: 1px solid var(--border); border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            padding: 6px; z-index: 100;
            animation: dropdownIn 0.15s ease-out;
        }
        [data-theme="dark"] .actions-menu {
            box-shadow: 0 8px 24px rgba(0,0,0,0.4);
        }
        @keyframes dropdownIn {
            from { opacity: 0; transform: translateY(-4px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .actions-menu-item {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px; border-radius: 8px; cursor: pointer;
            font-size: 14px; color: var(--text-secondary);
            border: none; background: none; width: 100%; text-align: left;
        }
        .actions-menu-item:hover { background: var(--bg-secondary); color: var(--text-primary); }
        .actions-menu-item svg { width: 16px; height: 16px; flex-shrink: 0; }

        .btn {
            padding: 8px 16px; border-radius: 4px; font-size: 14px; font-weight: 500;
            cursor: pointer; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-primary);
            transition: all 0.15s;
        }
        .btn:hover { background: var(--bg-tertiary); }
        .btn-primary { background: var(--text-primary); border-color: var(--text-primary); color: var(--bg-primary); }
        .btn-primary:hover { background: var(--text-secondary); border-color: var(--text-secondary); }
        .btn-sm { padding: 6px 12px; font-size: 13px; }
        .btn:focus-visible, .nav-item:focus-visible, .theme-toggle:focus-visible, .actions-btn:focus-visible, .tool-card:focus-visible, .choice-card:focus-visible {
            outline: 2px solid var(--accent); outline-offset: 2px;
        }

        .stats-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
        .stat-card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 20px; display: flex; flex-direction: column; }
        .stat-label { font-size: 12px; color: var(--text-tertiary); margin-bottom: 8px; }
        .stat-value { font-family: 'Instrument Serif', Georgia, serif; font-size: 32px; margin-bottom: 8px; }
        .stat-context { font-size: 13px; color: var(--text-secondary); display: inline-flex; align-items: center; gap: 8px; margin-top: auto; }

        .badge { display: inline-flex; padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
        .badge.good { background: var(--positive-light); color: var(--positive); }
        .badge.fair { background: var(--accent-light); color: var(--accent); }
        .badge.critical { background: var(--negative-light); color: var(--negative); }

        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; }
        .card-header { padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: flex-start; }
        .card-title { font-family: 'Instrument Serif', Georgia, serif; font-size: 18px; }
        .card-subtitle { font-size: 13px; color: var(--text-tertiary); margin-top: 2px; }
        .card-content { padding: 20px; }

        .revenue-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; }
        .revenue-item { padding: 16px; background: var(--bg-primary); border-radius: 8px; display: flex; flex-direction: column; }
        .revenue-name { font-size: 13px; color: var(--text-tertiary); margin-bottom: 8px; }
        .revenue-value { font-family: 'Instrument Serif', Georgia, serif; font-size: 20px; margin-bottom: 8px; }
        .revenue-bar { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; margin-bottom: 4px; margin-top: auto; }
        .revenue-bar-fill { height: 100%; background: var(--accent); border-radius: 2px; }

        .contract-list { display: flex; flex-direction: column; }
        .contract-item { padding: 14px 0; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .contract-item:last-child { border-bottom: none; }
        .contract-info { flex: 1; }
        .contract-name { font-family: 'Instrument Serif', Georgia, serif; font-size: 15px; margin-bottom: 2px; }
        .contract-meta { font-size: 13px; color: var(--text-tertiary); }
        .contract-value { font-family: 'IBM Plex Mono', monospace; font-size: 14px; margin-right: 12px; }
        .contract-health { width: 60px; height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; }
        .contract-health-fill { height: 100%; border-radius: 2px; }
        .contract-health-fill.good { background: var(--positive); }
        .contract-health-fill.fair { background: var(--accent); }
        .contract-health-fill.poor { background: var(--negative); }

        /* Scanner Styles */
        .scanner-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        .contract-input {
            width: 100%; min-height: 400px; padding: 16px; background: var(--bg-secondary);
            border: 1px solid var(--border); border-radius: 8px; font-family: 'IBM Plex Mono', monospace;
            font-size: 12px; line-height: 1.6; color: var(--text-primary); resize: vertical;
        }
        .contract-input:focus { outline: none; border-color: var(--accent); }
        .flags-list { display: flex; flex-direction: column; gap: 12px; max-height: 500px; overflow-y: auto; }
        .flag-item { padding: 16px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; display: flex; flex-direction: column; }
        .flag-header { display: inline-flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .flag-severity { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
        .flag-severity.critical { background: var(--negative); }
        .flag-severity.warning { background: var(--accent); }
        .flag-title { font-family: 'Instrument Serif', Georgia, serif; font-size: 15px; }
        .flag-clause { font-family: 'IBM Plex Mono', monospace; font-size: 13px; padding: 12px; background: var(--bg-primary); border-radius: 8px; margin-bottom: 12px; color: var(--text-secondary); border-left: 3px solid var(--border); }
        .flag-explanation { font-size: 13px; color: var(--text-secondary); margin-bottom: 12px; line-height: 1.6; }
        .flag-benchmark { font-size: 13px; padding: 12px 14px; background: var(--positive-light); border-radius: 8px; color: var(--positive); border-left: 3px solid var(--positive); }
        .flag-benchmark strong { font-weight: 600; }
        .flag-action { font-size: 13px; margin-top: 10px; padding: 12px; background: var(--bg-primary); border-radius: 4px; color: var(--text-secondary); }
        .flag-action strong { color: var(--accent); font-weight: 600; }
        .flag-template { margin-top: 8px; padding: 10px 12px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; font-family: 'IBM Plex Mono', monospace; font-size: 12px; line-height: 1.5; }
        .flag-copy { margin-top: 8px; font-size: 12px; color: var(--accent); cursor: pointer; font-weight: 500; }
        .flag-copy:hover { text-decoration: underline; }
        .scan-summary { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 20px; margin-bottom: 16px; }
        .scan-summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; text-align: center; }
        .summary-stat { padding: 12px; background: var(--bg-primary); border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .summary-stat-value { font-family: 'IBM Plex Mono', monospace; font-size: 20px; font-weight: 500; margin-bottom: 4px; }
        .summary-stat-label { font-size: 10px; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.5px; }

        /* Rate Check Styles */
        .ratecheck-container { max-width: 720px; margin: 0 auto; padding: 20px 0; }
        .ratecheck-progress { display: flex; gap: 8px; margin-bottom: 32px; }
        .ratecheck-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--border); transition: all 0.3s; }
        .ratecheck-dot.active { background: var(--accent); transform: scale(1.2); }
        .ratecheck-dot.completed { background: var(--text-primary); }
        .question-category { font-size: 11px; letter-spacing: 0.5px; text-transform: uppercase; color: var(--accent); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; font-weight: 500; }
        .question-category::before { content: ''; width: 20px; height: 2px; background: var(--accent); }
        .question-text { font-family: 'Instrument Serif', Georgia, serif; font-size: clamp(28px, 5vw, 40px); line-height: 1.2; letter-spacing: -1px; margin-bottom: 32px; }
        .choices-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 32px; }
        .choices-grid.single { grid-template-columns: 1fr; }
        .choice-card { padding: 20px; background: var(--bg-secondary); border: 2px solid var(--border); border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .choice-card:hover { transform: translateY(-2px); border-color: var(--text-secondary); }
        .choice-card.selected { background: var(--text-primary); color: var(--bg-primary); border-color: var(--text-primary); }
        .choice-card-text { font-size: 15px; font-weight: 500; margin-bottom: 4px; }
        .choice-card-sub { font-size: 13px; opacity: 0.6; }
        .rc-slider-container { margin-bottom: 32px; }
        .rc-slider-display { font-family: 'Instrument Serif', Georgia, serif; font-size: clamp(48px, 10vw, 64px); margin-bottom: 16px; }
        .rc-slider-track { position: relative; height: 8px; background: var(--border); border-radius: 4px; margin-bottom: 8px; }
        .rc-slider-fill { position: absolute; top: 0; left: 0; height: 100%; background: linear-gradient(90deg, var(--negative), var(--positive)); border-radius: 4px; }
        .rc-slider { width: 100%; height: 32px; -webkit-appearance: none; background: transparent; position: relative; z-index: 2; margin-top: -20px; }
        .rc-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; background: var(--text-primary); border-radius: 50%; cursor: grab; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        .rc-slider-labels { display: flex; justify-content: space-between; font-family: 'IBM Plex Mono', monospace; font-size: 10px; color: var(--text-tertiary); }
        .rc-slider-benchmark { margin-top: 12px; padding: 10px 14px; background: var(--positive-light); border-radius: 8px; font-size: 13px; color: var(--positive); display: flex; align-items: center; gap: 8px; }
        .rc-slider-benchmark::before { content: ''; width: 6px; height: 6px; background: var(--positive); border-radius: 50%; }
        .rc-comparison { margin-top: 12px; padding: 12px 16px; border-radius: 8px; display: flex; align-items: center; gap: 10px; font-size: 14px; font-weight: 500; }
        .rc-comparison.above { background: var(--positive-light); color: var(--positive); }
        .rc-comparison.below { background: var(--negative-light); color: var(--negative); }
        .rc-comparison.average { background: var(--accent-light); color: var(--accent); }
        .rc-hint { font-size: 13px; color: var(--text-tertiary); margin-top: 16px; padding: 12px; background: var(--bg-tertiary); border-radius: 8px; }
        .rc-results { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .rc-score { font-family: 'Instrument Serif', Georgia, serif; font-size: clamp(80px, 20vw, 140px); line-height: 0.9; margin-bottom: 16px; }
        .rc-grade { display: inline-flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; padding: 8px 16px; border-radius: 4px; margin-bottom: 24px; }
        .rc-grade.excellent { background: var(--positive); color: #fff; }
        .rc-grade.good { background: var(--positive); color: #fff; }
        .rc-grade.fair { background: var(--accent); color: #fff; }
        .rc-grade.poor { background: var(--negative); color: #fff; }
        .rc-summary { font-size: 16px; color: var(--text-secondary); max-width: 400px; margin: 0 auto 32px; line-height: 1.6; }
        .rc-results-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 24px; text-align: left; width: 100%; }
        .rc-result-card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 16px; display: flex; flex-direction: column; }
        .rc-result-label { font-size: 11px; letter-spacing: 0.5px; text-transform: uppercase; color: var(--text-tertiary); margin-bottom: 8px; font-weight: 500; }
        .rc-result-value { font-family: 'Instrument Serif', Georgia, serif; font-size: 24px; margin-bottom: 4px; }
        .rc-result-context { font-size: 13px; color: var(--text-tertiary); }
        .rc-insight { background: var(--text-primary); color: var(--bg-primary); padding: 20px; border-radius: 8px; margin-bottom: 24px; text-align: left; width: 100%; }
        .rc-insight-title { font-family: 'Instrument Serif', Georgia, serif; font-size: 16px; margin-bottom: 8px; }
        .rc-insight-text { font-size: 14px; opacity: 0.8; line-height: 1.5; }

        /* Wrapped Styles - Split screen like entry */
        .wrapped-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-height: 500px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            user-select: none;
        }
        .wrapped-left {
            background: var(--bg-secondary);
            padding: 48px;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
            border-right: none;
            border-radius: 8px 0 0 8px;
        }
        .wrapped-slide-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .wrapped-nav-buttons {
            display: flex;
            gap: 8px;
            margin-top: 24px;
            flex-shrink: 0;
        }
        .wrapped-right {
            background: var(--accent);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0 8px 8px 0;
        }
        .wrapped-right::before {
            content: '';
            position: absolute;
            inset: 0;
            background:
                radial-gradient(circle at 30% 20%, rgba(255,255,255,0.1) 0%, transparent 40%),
                radial-gradient(circle at 70% 80%, rgba(0,0,0,0.2) 0%, transparent 40%);
        }
        .wrapped-right::after {
            content: '';
            position: absolute;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.08);
            border-radius: 50%;
            filter: blur(40px);
            animation: wrappedFloat 8s ease-in-out infinite;
        }
        @keyframes wrappedFloat {
            0%, 100% { transform: translate(-30%, -30%); }
            50% { transform: translate(30%, 30%); }
        }
        /* Floating fragments for wrapped */
        .wrapped-fragments {
            position: absolute;
            inset: 0;
            overflow: hidden;
        }
        .wrapped-fragment {
            position: absolute;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            color: rgba(255,255,255,0.4);
            padding: 8px 12px;
            background: rgba(255,255,255,0.08);
            border-radius: 4px;
            white-space: nowrap;
            animation: fragmentFloat 20s ease-in-out infinite;
        }
        .wrapped-fragment:nth-child(1) { top: 8%; left: 8%; animation-delay: 0s; }
        .wrapped-fragment:nth-child(2) { top: 18%; right: 12%; animation-delay: -2s; }
        .wrapped-fragment:nth-child(3) { top: 32%; left: 5%; animation-delay: -4s; }
        .wrapped-fragment:nth-child(4) { top: 28%; right: 8%; animation-delay: -6s; }
        .wrapped-fragment:nth-child(5) { top: 48%; left: 12%; animation-delay: -8s; }
        .wrapped-fragment:nth-child(6) { top: 52%; right: 15%; animation-delay: -10s; }
        .wrapped-fragment:nth-child(7) { top: 65%; left: 6%; animation-delay: -12s; }
        .wrapped-fragment:nth-child(8) { top: 70%; right: 10%; animation-delay: -14s; }
        .wrapped-fragment:nth-child(9) { top: 82%; left: 18%; animation-delay: -16s; }
        .wrapped-fragment:nth-child(10) { top: 85%; right: 20%; animation-delay: -18s; }
        .wrapped-fragment.highlight {
            background: rgba(255,255,255,0.15);
            color: rgba(255,255,255,0.7);
            font-size: 12px;
        }
        @keyframes fragmentFloat {
            0%, 100% { transform: translate(0, 0); opacity: 0.4; }
            25% { transform: translate(10px, -10px); opacity: 0.6; }
            50% { transform: translate(5px, 5px); opacity: 0.4; }
            75% { transform: translate(-5px, -5px); opacity: 0.5; }
        }
        .wrapped-progress {
            display: flex;
            gap: 6px;
            margin-bottom: 32px;
        }
        .wrapped-segment {
            flex: 1;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            transition: background 0.3s;
        }
        .wrapped-segment.active { background: var(--accent); }
        .wrapped-label {
            font-size: 11px;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--text-tertiary);
            margin-bottom: 16px;
        }
        .wrapped-title {
            font-family: 'Instrument Serif', Georgia, serif;
            font-size: 32px;
            margin-bottom: 16px;
            line-height: 1.2;
        }
        .wrapped-context {
            font-size: 15px;
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 320px;
        }
        .wrapped-stat {
            position: relative;
            z-index: 1;
            text-align: center;
            color: rgba(255,255,255,0.95);
        }
        .wrapped-stat-value {
            font-family: 'Instrument Serif', Georgia, serif;
            font-size: clamp(80px, 12vw, 140px);
            line-height: 0.9;
            letter-spacing: -4px;
        }
        .wrapped-stat-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            letter-spacing: 2px;
            text-transform: uppercase;
            opacity: 0.6;
            margin-top: 16px;
        }
        .wrapped-nav {
            margin-top: 32px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            color: var(--text-tertiary);
        }
        .wrapped-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        /* Simulator Styles */
        .sim-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        .slider-group { margin-bottom: 20px; }
        .slider-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .slider-label { font-size: 13px; font-weight: 500; }
        .slider-value { font-family: 'IBM Plex Mono', monospace; font-size: 13px; color: var(--accent); }
        .slider { width: 100%; height: 6px; -webkit-appearance: none; background: var(--border); border-radius: 3px; }
        .slider::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: var(--text-primary); border-radius: 50%; cursor: pointer; border: 3px solid var(--bg-secondary); }
        .slider-hint { font-size: 10px; color: var(--text-tertiary); margin-top: 6px; }
        .result-card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 20px; margin-bottom: 16px; display: flex; flex-direction: column; }
        .result-label { font-size: 11px; letter-spacing: 0.5px; text-transform: uppercase; color: var(--text-tertiary); margin-bottom: 8px; font-weight: 500; }
        .result-value { font-family: 'Instrument Serif', Georgia, serif; font-size: 40px; }
        .result-value.positive { color: var(--positive); }

        /* Intel Styles */
        .intel-filters { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-btn { padding: 6px 14px; border-radius: 4px; font-size: 12px; cursor: pointer; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-secondary); }
        .filter-btn:hover { background: var(--bg-tertiary); }
        .filter-btn.active { background: var(--text-primary); border-color: var(--text-primary); color: var(--bg-primary); }
        .deal-feed { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .deal-card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 16px; display: flex; flex-direction: column; }
        .deal-card:hover { border-color: var(--accent); }
        .deal-header { display: inline-flex; justify-content: space-between; align-items: center; margin-bottom: 10px; gap: 8px; }
        .deal-type { font-size: 10px; letter-spacing: 0.5px; text-transform: uppercase; font-weight: 600; padding: 3px 8px; border-radius: 4px; }
        .deal-type { background: var(--bg-tertiary); color: var(--text-secondary); }
        .deal-title { font-family: 'Instrument Serif', Georgia, serif; font-size: 16px; margin-bottom: 12px; }
        .deal-details { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .detail-item { text-align: center; padding: 8px; background: var(--bg-primary); border-radius: 4px; }
        .detail-value { font-family: 'IBM Plex Mono', monospace; font-size: 12px; font-weight: 500; margin-bottom: 2px; }
        .detail-label { font-size: 10px; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.5px; }

        .cta-card { grid-column: span 2; background: var(--text-primary); color: var(--bg-primary); border-radius: 8px; padding: 24px; display: flex; align-items: center; justify-content: space-between; }
        .cta-title { font-family: 'Instrument Serif', Georgia, serif; font-size: 20px; margin-bottom: 4px; }
        .cta-text { font-size: 14px; opacity: 0.7; }
        .cta-btn { padding: 10px 20px; background: var(--bg-primary); color: var(--text-primary); border: none; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; }

        /* Nudges/Alerts */
        .nudges-section { margin-bottom: 24px; }
        .nudges-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .nudges-title { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: var(--text-tertiary); }
        .nudges-list { display: flex; flex-direction: column; gap: 8px; }
        .nudges-collapsed {
            display: flex; align-items: center; gap: 12px; padding: 12px 16px;
            background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px;
            cursor: pointer; transition: all 0.2s ease;
        }
        .nudges-collapsed:hover { border-color: var(--text-tertiary); }
        .nudges-expanded { animation: slideDown 0.2s ease-out; }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .nudge-item { display: flex; align-items: center; gap: 12px; padding: 14px 16px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; transition: all 0.15s; }
        .nudge-item:hover { border-color: var(--text-tertiary); }
        .nudge-item.high { border-left: 3px solid var(--negative); }
        .nudge-item.medium { border-left: 3px solid var(--accent); }
        .nudge-item.low { border-left: 3px solid var(--accent); }
        .nudge-icon { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 14px; }
        .nudge-icon.alert { background: var(--negative-light); color: var(--negative); }
        .nudge-icon.reminder { background: var(--accent-light); color: var(--accent); }
        .nudge-icon.opportunity { background: var(--positive-light); color: var(--positive); }
        .nudge-icon.insight { background: var(--accent-light); color: var(--accent); }
        .nudge-content { flex: 1; min-width: 0; }
        .nudge-title { font-size: 13px; font-weight: 500; margin-bottom: 2px; }
        .nudge-action { font-size: 12px; color: var(--accent); cursor: pointer; }
        .nudge-action:hover { text-decoration: underline; }
        .nudge-dismiss { width: 24px; height: 24px; border-radius: 4px; border: none; background: transparent; color: var(--text-tertiary); cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .nudge-dismiss:hover { background: var(--bg-tertiary); color: var(--text-secondary); }

        /* Tools Grid */
        .tools-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
        .tool-card { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 24px; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; }
        .tool-card:hover { border-color: var(--text-tertiary); transform: translateY(-2px); }
        .tool-icon { width: 48px; height: 48px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-bottom: 16px; }
        .tool-icon.scanner { background: var(--negative-light); color: var(--negative); }
        .tool-icon.simulator { background: var(--accent-light); color: var(--accent); }
        .tool-icon.ratecheck { background: var(--positive-light); color: var(--positive); }
        .tool-name { font-family: 'Instrument Serif', Georgia, serif; font-size: 16px; margin-bottom: 6px; }
        .tool-desc { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }

        .page-intro { margin-bottom: 24px; }
        .page-title { font-family: 'Instrument Serif', Georgia, serif; font-size: 28px; margin-bottom: 8px; }
        .page-subtitle { color: var(--text-secondary); font-size: 14px; }

        @media (max-width: 1000px) {
            .main-grid, .scanner-grid, .sim-grid { grid-template-columns: 1fr; }
            .cta-card { grid-column: span 1; }
            .revenue-grid { grid-template-columns: repeat(3, 1fr); }
            .stats-row { grid-template-columns: 1fr; }
            .tools-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 600px) {
            .dashboard { padding: 16px 12px; max-width: 100%; }
            .header { flex-direction: column; gap: 12px; align-items: stretch; }
            .header-left { flex-direction: column; gap: 12px; align-items: flex-start; }
            .header-nav {
                width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch;
                padding-bottom: 4px; gap: 4px;
            }
            .nav-item { flex-shrink: 0; padding: 6px 12px; font-size: 12px; }
            .header-actions { position: absolute; top: 16px; right: 12px; }
            .actions-btn { padding: 6px 10px; font-size: 12px; }
            .actions-menu { min-width: 180px; right: -40px; }
            .stats-row { gap: 8px; }
            .stat-card { padding: 16px; }
            .stat-value { font-size: 24px; }
            .stat-label { font-size: 10px; }
            .card { border-radius: 8px; }
            .card-content { padding: 16px; }
            .revenue-grid { grid-template-columns: 1fr 1fr; gap: 8px; }
            .revenue-item { padding: 12px; }
            .deal-feed { grid-template-columns: 1fr; gap: 8px; }
            .deal-card { padding: 12px; }
            .deal-details { grid-template-columns: repeat(2, 1fr); gap: 6px; }
            .choices-grid { grid-template-columns: 1fr; gap: 8px; }
            .choice-card { padding: 16px; }
            .wrapped-container { grid-template-columns: 1fr; min-height: 400px; }
            .wrapped-left { border-radius: 8px 8px 0 0; border-right: 1px solid var(--border); border-bottom: none; }
            .wrapped-right { border-radius: 0 0 8px 8px; min-height: 250px; }
            .page-title { font-size: 22px; }
            .page-subtitle { font-size: 13px; }
            .tool-card { padding: 16px; border-radius: 8px; }
            .tool-icon { width: 36px; height: 36px; margin-bottom: 10px; border-radius: 8px; }
            .tool-name { font-size: 14px; }
            .tool-desc { font-size: 12px; }
            .rc-results-grid { grid-template-columns: 1fr; gap: 8px; }
            .rc-result-card { padding: 12px; }
            .scan-summary-grid { grid-template-columns: 1fr; gap: 8px; }
            .scanner-grid { gap: 16px; }
            .contract-input { font-size: 12px; min-height: 150px; }
            .flag-item { padding: 12px; }
            .cta-card { padding: 16px; flex-direction: column; gap: 12px; align-items: flex-start; }
            .nudge-item { padding: 12px; }
            .ratecheck-container { padding: 0; }
            .question-text { font-size: clamp(24px, 5vw, 32px); margin-bottom: 24px; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Dashboard Data
        const dashboardData = {
            revenue: 12847, percentile: 78, streamRate: 0.0038, takeRate: 72,
            channels: [
                { name: 'Streaming', value: 4500, percentile: 65 },
                { name: 'Sync', value: 7200, percentile: 82 },
                { name: 'Merch', value: 3800, percentile: 45 },
                { name: 'Live', value: 8500, percentile: 71 },
                { name: 'Royalties', value: 5600, percentile: 68 }
            ],
            contracts: [
                { name: 'Sony Music Publishing', type: 'Sync license', value: 24000, health: 85 },
                { name: 'Distribution Agreement', type: 'Label services', value: null, health: 62 },
                { name: 'Nike Partnership', type: 'Brand deal', value: 48000, health: 91 }
            ]
        };

        // Sample Contract for Scanner
        const sampleContract = `MUSIC LICENSING AND DISTRIBUTION AGREEMENT

This Agreement is entered into between Artist ("Licensor") and MegaMusic Corp ("Licensee").

1. GRANT OF RIGHTS
Licensor hereby grants to Licensee the exclusive worldwide rights to distribute, license, and exploit the Masters in perpetuity across all territories and all media now known or hereafter devised.

2. REVENUE SHARE
Licensee shall pay Licensor thirty percent (30%) of Net Receipts after deduction of distribution fees, marketing costs, and a packaging deduction of 25% of retail price for all formats including digital.

3. ADVANCES AND RECOUPMENT
Licensee shall pay an advance of $15,000, which shall be fully recoupable from Licensor's share of Net Receipts. All marketing expenses, video production costs, and tour support shall be recoupable at 100%.

4. CONTROLLED COMPOSITION
For controlled compositions, Licensor agrees to license at 75% of the statutory mechanical rate for albums and 50% for singles.

5. RIGHTS ASSIGNMENT
Licensor hereby assigns and transfers all right, title and interest in the Masters to Licensee, including copyright ownership.

6. FIRST RIGHT OF REFUSAL
Licensee shall have a first right of refusal and matching right for Licensor's next three (3) albums on substantially similar terms.

7. TERMINATION
This agreement may be terminated by Licensee upon 30 days written notice for any reason. Licensor may only terminate for material breach after a 90-day cure period.

8. AUDIT RIGHTS
Licensor may audit Licensee's books once annually upon 60 days notice, at Licensor's expense regardless of findings.`;

        // Red Flag Patterns
        const redFlagPatterns = [
            { pattern: /perpetuity|in perpetuity|forever/i, severity: 'critical', title: 'Perpetuity clause', explanation: 'Grants rights indefinitely. Most deals are 3-5 years.', benchmark: '78% of similar deals have defined terms', action: 'Request a 3-5 year term with reversion rights', template: "I'd like to modify Section [X] to include a defined term of [3-5] years, with full reversion of rights upon expiration or termination. This is standard for deals at my level." },
            { pattern: /30%|thirty percent/i, severity: 'critical', title: 'High revenue cut', explanation: '30% is extremely high. Standard distributor cuts are 0-15%.', benchmark: 'Top distributors charge 0-15%', action: 'Counter with 10-15% or switch to flat-fee distribution', template: "The proposed 30% distribution fee is significantly above market rate. I'd like to propose [10-15]% which aligns with industry standards for artists at my streaming level." },
            { pattern: /packaging deduction|25% of retail/i, severity: 'critical', title: 'Packaging deductions', explanation: 'Packaging deductions for digital are outdated and exploitative.', benchmark: '94% of digital deals have no packaging deductions', action: 'Strike this clause entirely - it should not apply to digital', template: "I'd like to strike the packaging deduction clause entirely. This is a legacy provision from physical media that doesn't apply to digital distribution and is not included in modern agreements." },
            { pattern: /recoupable|recoupment/i, severity: 'warning', title: 'Broad recoupment', explanation: 'Marketing and tour support being recoupable can trap you in debt.', benchmark: '65% of artists cap recoupable expenses', action: 'Cap recoupable costs or limit to advance only', template: "I'd like to modify the recoupment terms to cap recoupable expenses at $[X] or limit recoupment to the advance only. Marketing and tour support should be the label's investment, not an artist debt." },
            { pattern: /controlled composition|75% of.*statutory/i, severity: 'critical', title: 'Controlled composition', explanation: 'Reduces your mechanical royalties. Outdated and unfair practice.', benchmark: '89% of modern indie deals exclude this clause', action: 'Strike this clause - demand full statutory rate', template: "I'd like to strike the controlled composition clause. I expect to receive 100% of the statutory mechanical rate, which is standard practice in modern independent agreements." },
            { pattern: /assigns.*transfers.*ownership|transfer.*copyright/i, severity: 'critical', title: 'Copyright transfer', explanation: 'You are giving away ownership of your masters permanently.', benchmark: 'Only 12% of indie artists transfer master ownership', action: 'Insist on exclusive license instead of ownership transfer', template: "I cannot agree to transfer copyright ownership. I'd like to modify this to an exclusive license for the term of the agreement, with ownership remaining with me throughout." },
            { pattern: /first right of refusal|matching right/i, severity: 'warning', title: 'Right of first refusal', explanation: 'Limits your ability to sign better deals elsewhere.', benchmark: '62% of artists negotiate this out or limit to 30 days', action: 'Remove or limit matching period to 15-30 days', template: "I'd like to either remove the right of first refusal, or limit the matching period to [15-30] days with a requirement that any match be on identical terms, not just substantially similar." },
            { pattern: /terminated by Licensee.*30 days|terminate.*for any reason/i, severity: 'warning', title: 'One-sided termination', explanation: 'Label can leave easily while you are bound for the full term.', benchmark: '71% of fair contracts have mutual termination rights', action: 'Add mutual termination rights with same notice period', template: "I'd like to add mutual termination rights—if Licensee can terminate with 30 days notice, I should have the same option. Alternatively, remove termination for convenience entirely." }
        ];

        // Community Intel Deals
        const communityDeals = [
            { id: 1, type: 'sync', title: 'Netflix series', time: '2d', tier: '100K-500K', value: 8500, term: '3yr', win: '+23%' },
            { id: 2, type: 'distribution', title: 'Switched distributor', time: '5d', tier: '50K-100K', value: null, term: '1yr', win: '30%→9%' },
            { id: 3, type: 'brand', title: 'Nike campaign', time: '1w', tier: '500K-1M', value: 45000, term: '6mo', win: 'Kept masters' },
            { id: 4, type: 'sync', title: 'Video game trailer', time: '1w', tier: '10K-50K', value: 3200, term: '2yr', win: 'First sync!' },
            { id: 5, type: 'brand', title: 'Beverage commercial', time: '2w', tier: '100K-500K', value: 18000, term: '1yr', win: '+40% vs offer' },
            { id: 6, type: 'distribution', title: 'Left label services', time: '2w', tier: '500K-1M', value: null, term: '0', win: 'Freedom' },
            { id: 7, type: 'sync', title: 'Indie film score', time: '3w', tier: '10K-50K', value: 5000, term: '5yr', win: 'Backend %' },
            { id: 8, type: 'brand', title: 'Fashion week', time: '3w', tier: '100K-500K', value: 22000, term: '3mo', win: 'No exclusivity' },
            { id: 9, type: 'sync', title: 'TV commercial', time: '1mo', tier: '500K-1M', value: 35000, term: '1yr', win: 'Territory limits' },
            { id: 10, type: 'distribution', title: 'Better split renegotiation', time: '1mo', tier: '50K-100K', value: null, term: '2yr', win: '85/15 split' },
            { id: 11, type: 'brand', title: 'Tech product launch', time: '1mo', tier: '100K-500K', value: 28000, term: '6mo', win: '+$8K vs initial' },
            { id: 12, type: 'sync', title: 'Podcast theme', time: '1mo', tier: '10K-50K', value: 1500, term: '2yr', win: 'Recurring fee' }
        ];

        // Rate Check Questions
        const rcQuestions = [
            { id: 'listeners', category: 'Your reach', question: 'How many monthly listeners do you have?', type: 'choice', columns: 2, choices: [
                { value: 'under10k', label: 'Under 10K', sub: 'Building momentum' },
                { value: '10k-50k', label: '10K - 50K', sub: 'Growing audience' },
                { value: '50k-250k', label: '50K - 250K', sub: 'Solid fanbase' },
                { value: '250k-1m', label: '250K - 1M', sub: 'Major traction' },
                { value: 'over1m', label: '1M+', sub: 'Top tier' }
            ]},
            { id: 'streamRate', category: 'Streaming', question: "What's your average per-stream rate?", type: 'slider', min: 0.001, max: 0.008, step: 0.0001, default: 0.003, format: 'currency', benchmark: { value: 0.0033, label: 'Industry median' }, hint: "Find this in your distributor dashboard under royalties." },
            { id: 'distributorCut', category: 'Distribution', question: 'What percentage does your distributor take?', type: 'slider', min: 0, max: 40, step: 1, default: 15, format: 'percent', benchmark: { value: 15, label: 'Standard rate' }, inverse: true, hint: "Check your distribution agreement for your revenue split." },
            { id: 'ownsMasters', category: 'Ownership', question: 'Do you own your masters?', type: 'choice', columns: 2, choices: [
                { value: 'yes', label: 'Yes, 100%', sub: 'Full ownership' },
                { value: 'partial', label: 'Partial', sub: 'Split ownership' },
                { value: 'no', label: 'No', sub: 'Label owns' },
                { value: 'unsure', label: 'Not sure', sub: 'Need to check' }
            ]},
            { id: 'monthlyRevenue', category: 'Revenue', question: "What's your average monthly revenue?", type: 'slider', min: 0, max: 100000, step: 500, default: 5000, format: 'dollar', hint: "Include all sources: streaming, sync, merch, live, etc." },
            { id: 'revenueStreams', category: 'Diversification', question: 'How many income streams do you have?', type: 'choice', columns: 2, choices: [
                { value: '1', label: 'Just streaming', sub: 'Single source' },
                { value: '2-3', label: '2-3 sources', sub: 'Some diversification' },
                { value: '4-5', label: '4-5 sources', sub: 'Well diversified' },
                { value: '6+', label: '6+ sources', sub: 'Highly diversified' }
            ]}
        ];

        const rcBenchmarks = {
            streamRate: { median: 0.0033, p75: 0.004, p25: 0.0028 },
            distributorCut: { median: 15, p75: 12, p25: 20 },
            monthlyRevenue: { 'under10k': { median: 500 }, '10k-50k': { median: 3000 }, '50k-250k': { median: 12000 }, '250k-1m': { median: 35000 }, 'over1m': { median: 100000 } }
        };

        // Wrapped Data
        const wrappedData = {
            year: 2024, contractsReviewed: 12, dealsDodged: 3, moneySaved: 47000, rateImprovement: 34, benchmarksChecked: 89, percentile: 18, topWin: 'Sync license', topWinAmount: 8500, dataContributions: 6, artistsHelped: 2400
        };

        function App() {
            // Get initial tab from URL hash
            const getTabFromUrl = () => {
                const hash = window.location.hash.slice(1);
                const validTabs = ['dashboard', 'contracts', 'rates', 'tools', 'intel'];
                return validTabs.includes(hash) ? hash : 'dashboard';
            };

            const [activeTab, setActiveTab] = useState(getTabFromUrl);
            const [theme, setTheme] = useState(() => {
                try { return localStorage.getItem('ceo-theme') || 'light'; }
                catch { return 'light'; }
            });
            const [insightIndex, setInsightIndex] = useState(0);

            // Update URL when tab changes
            const handleTabChange = (tab) => {
                setActiveTab(tab);
                window.history.pushState(null, '', `#${tab}`);
                window.scrollTo(0, 0);
            };

            // Handle browser back/forward
            React.useEffect(() => {
                const handlePopState = () => {
                    setActiveTab(getTabFromUrl());
                };
                window.addEventListener('popstate', handlePopState);
                return () => window.removeEventListener('popstate', handlePopState);
            }, []);

            // Insights carousel data
            const insights = [
                {
                    label: 'TOUR GAP',
                    title: 'Your Berlin fans are waiting',
                    body: "11% of your streams come from Berlin, but you haven't played there since 2022. Similar artists average 2 shows per year in the city.",
                    cta: 'See venue data',
                    action: 'venues'
                },
                {
                    label: 'RATE ALERT',
                    title: "You're below market rate",
                    body: 'Your average per-stream is $0.0031. Artists at your level typically earn $0.0038. This gap cost you ~$840 last month.',
                    cta: 'Compare rates',
                    action: 'rates'
                },
                {
                    label: 'SYNC MATCH',
                    title: 'Your sound fits a trending brief',
                    body: '3 music supervisors searched for "atmospheric electronic" this week. Your track "Retrograde" matches the mood profile.',
                    cta: 'View brief',
                    action: 'sync'
                },
                {
                    label: 'MOMENTUM',
                    title: 'Growth spike in Australia',
                    body: 'Your streams in Sydney grew 47% this month. Consider pitching to Spotify\'s "Fresh Finds AU" — similar artists saw 3x boost.',
                    cta: 'See playlist data',
                    action: 'playlists'
                }
            ];

            // Navigate insights
            const prevInsight = () => setInsightIndex(i => (i - 1 + insights.length) % insights.length);
            const nextInsight = () => setInsightIndex(i => (i + 1) % insights.length);

            // Scanner state
            const [contractText, setContractText] = useState('');
            const [scanResults, setScanResults] = useState(null);
            const [scanning, setScanning] = useState(false);

            // Simulator state
            const [streams, setStreams] = useState(500000);
            const [rate, setRate] = useState(0.003);
            const [distCut, setDistCut] = useState(15);
            const [pubShare, setPubShare] = useState(50);
            const [termYears, setTermYears] = useState(5);
            const [altDistCut, setAltDistCut] = useState(0);
            const [altPubShare, setAltPubShare] = useState(100);

            // Intel state
            const [intelFilter, setIntelFilter] = useState('all');

            // Rate Check state
            const [rcStep, setRcStep] = useState(-1);
            const [rcAnswers, setRcAnswers] = useState({});
            const [rcCurrentValue, setRcCurrentValue] = useState('');

            // Wrapped state
            const [wrappedSlide, setWrappedSlide] = useState(0);

            // Contribute state
            const [showContribute, setShowContribute] = useState(false);
            const [contributed, setContributed] = useState(false);

            // Tools tab state
            const [activeTool, setActiveTool] = useState(null);

            // Actions dropdown state
            const [actionsOpen, setActionsOpen] = useState(false);

            useEffect(() => {
                document.documentElement.setAttribute('data-theme', theme);
                try { localStorage.setItem('ceo-theme', theme); }
                catch { /* localStorage unavailable */ }
            }, [theme]);

            // Close actions dropdown when clicking outside
            useEffect(() => {
                const handleClickOutside = (e) => {
                    if (actionsOpen && !e.target.closest('.actions-dropdown')) {
                        setActionsOpen(false);
                    }
                };
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, [actionsOpen]);

            const loadSampleContract = () => {
                setContractText(sampleContract);
                setScanResults(null);
            };

            const scanContract = () => {
                if (!contractText.trim()) return;
                setScanning(true);
                setTimeout(() => {
                    const flags = [];
                    redFlagPatterns.forEach(p => {
                        const matches = contractText.match(p.pattern);
                        if (matches) {
                            const idx = contractText.toLowerCase().indexOf(matches[0].toLowerCase());
                            const clause = '...' + contractText.substring(Math.max(0, idx - 30), Math.min(contractText.length, idx + matches[0].length + 80)).trim() + '...';
                            flags.push({ ...p, clause });
                        }
                    });
                    const criticalCount = flags.filter(f => f.severity === 'critical').length;
                    const warningCount = flags.filter(f => f.severity === 'warning').length;
                    const score = Math.max(10, 100 - (criticalCount * 10) - (warningCount * 5));
                    setScanResults({ flags, score });
                    setScanning(false);
                }, 1000);
            };

            // Simulator calculations
            const simCalcs = useMemo(() => {
                const yearly = streams * rate * 12;
                const currentNet = Math.max(0, yearly * (1 - distCut/100) * (pubShare/100));
                const altNet = Math.max(0, yearly * (1 - altDistCut/100) * (altPubShare/100));
                let currentTotal = 0, altTotal = 0;
                for (let y = 1; y <= termYears; y++) {
                    const growth = Math.pow(1.1, y - 1);
                    currentTotal += currentNet * growth;
                    altTotal += altNet * growth;
                }
                const diff = altTotal - currentTotal;
                return { yearly, currentNet, altNet, currentTotal, altTotal, diff, isGain: diff >= 0 };
            }, [streams, rate, distCut, pubShare, termYears, altDistCut, altPubShare]);

            const formatCurrency = (n) => {
                const abs = Math.abs(n);
                if (abs >= 1000000) return `$${(abs/1000000).toFixed(1)}M`;
                if (abs >= 1000) return `$${(abs/1000).toFixed(1)}K`;
                return `$${abs.toFixed(0)}`;
            };

            // Rate Check helpers
            const formatRcValue = (value, format) => {
                if (format === 'currency') return `$${value.toFixed(4)}`;
                if (format === 'percent') return `${value}%`;
                if (format === 'dollar') return `$${value.toLocaleString()}`;
                return value;
            };

            const calculateRcScore = () => {
                let score = 50;
                let insights = [];
                if (rcAnswers.streamRate >= 0.004) score += 12;
                else if (rcAnswers.streamRate >= 0.0033) score += 6;
                else if (rcAnswers.streamRate && rcAnswers.streamRate < 0.003) score -= 8;
                if (rcAnswers.distributorCut !== undefined) {
                    if (rcAnswers.distributorCut <= 12) score += 10;
                    else if (rcAnswers.distributorCut <= 15) score += 5;
                    else if (rcAnswers.distributorCut > 20) score -= 10;
                }
                if (rcAnswers.ownsMasters === 'yes') score += 15;
                else if (rcAnswers.ownsMasters === 'partial') score += 5;
                else if (rcAnswers.ownsMasters === 'no') { score -= 10; insights.push("Not owning your masters significantly impacts long-term earnings."); }
                if (rcAnswers.revenueStreams === '6+') score += 10;
                else if (rcAnswers.revenueStreams === '4-5') score += 6;
                else if (rcAnswers.revenueStreams === '1') { score -= 5; insights.push("Relying solely on streaming is risky. Top earners have 4+ income sources."); }
                return { score: Math.max(0, Math.min(100, score)), insights };
            };

            const getRcGrade = (score) => {
                if (score >= 80) return { label: 'EXCELLENT DEAL', cls: 'excellent' };
                if (score >= 65) return { label: 'GOOD POSITION', cls: 'good' };
                if (score >= 45) return { label: 'ROOM TO IMPROVE', cls: 'fair' };
                return { label: 'NEEDS ATTENTION', cls: 'poor' };
            };

            const handleRcNext = () => {
                if (rcStep >= 0 && rcStep < rcQuestions.length) {
                    const q = rcQuestions[rcStep];
                    if (rcCurrentValue !== '') {
                        setRcAnswers(prev => ({ ...prev, [q.id]: rcCurrentValue }));
                    }
                }
                const nextStep = rcStep + 1;
                setRcStep(nextStep);
                if (nextStep < rcQuestions.length) {
                    const nextQ = rcQuestions[nextStep];
                    setRcCurrentValue(nextQ.type === 'slider' ? nextQ.default : '');
                }
            };

            const handleWrappedClick = (e) => {
                // On first slide, any click advances
                if (wrappedSlide === 0) {
                    setWrappedSlide(1);
                    return;
                }
                const rect = e.currentTarget.getBoundingClientRect();
                const x = e.clientX - rect.left;
                if (x > rect.width / 2 && wrappedSlide < 6) setWrappedSlide(s => s + 1);
                else if (x <= rect.width / 2 && wrappedSlide > 0) setWrappedSlide(s => s - 1);
            };

            return (
                <div className="dashboard">
                    <header className="header">
                        <div className="header-left">
                            <div className="logo" onClick={() => handleTabChange('dashboard')}>CEO</div>
                            <nav className="header-nav">
                                {[{id: 'dashboard', label: 'Dashboard'}, {id: 'contracts', label: 'Contracts'}, {id: 'intel', label: 'Intel'}, {id: 'tools', label: 'Tools'}, {id: 'wrapped', label: '2024'}].map(tab => (
                                    <button key={tab.id} className={`nav-item ${activeTab === tab.id ? 'active' : ''}`} onClick={() => { handleTabChange(tab.id); setActiveTool(null); }}>
                                        {tab.label}
                                    </button>
                                ))}
                            </nav>
                        </div>
                        <div className="header-actions">
                            <div className="actions-dropdown">
                                <button className="actions-btn" onClick={(e) => { e.stopPropagation(); setActionsOpen(!actionsOpen); }}>
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                    Actions
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{marginLeft: '2px'}}><polyline points="6 9 12 15 18 9"/></svg>
                                </button>
                                {actionsOpen && (
                                    <div className="actions-menu">
                                        <button className="actions-menu-item" onClick={() => { handleTabChange('tools'); setActiveTool('scanner'); setActionsOpen(false); }}>
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>
                                            Scan a contract
                                        </button>
                                        <button className="actions-menu-item" onClick={() => { handleTabChange('tools'); setActiveTool('simulator'); setActionsOpen(false); }}>
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                                            Model a deal
                                        </button>
                                        <button className="actions-menu-item" onClick={() => { handleTabChange('tools'); setActiveTool('ratecheck'); setActionsOpen(false); }}>
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                                            Run rate check
                                        </button>
                                        <button className="actions-menu-item" onClick={() => { handleTabChange('intel'); setActionsOpen(false); }}>
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                                            Browse community intel
                                        </button>
                                    </div>
                                )}
                            </div>
                            <button className="theme-toggle" onClick={() => setTheme(t => t === 'light' ? 'dark' : 'light')} aria-label={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}>
                                {theme === 'light' ? (
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" aria-hidden="true"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                                ) : (
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" aria-hidden="true"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/></svg>
                                )}
                            </button>
                        </div>
                    </header>

                    {/* DASHBOARD TAB */}
                    {activeTab === 'dashboard' && (
                        <>
                            {/* Top stats row */}
                            <div className="stats-row">
                                <div className="stat-card">
                                    <div className="stat-label">Monthly revenue</div>
                                    <div className="stat-value">${dashboardData.revenue.toLocaleString()}</div>
                                    <div className="stat-context"><span className="badge good">{dashboardData.percentile}th percentile</span> in your tier</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-label">Per-stream rate</div>
                                    <div className="stat-value">${dashboardData.streamRate.toFixed(4)}</div>
                                    <div className="stat-context"><span className="badge good">+15%</span> vs industry avg</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-label">Contract health</div>
                                    <div className="stat-value">Good</div>
                                    <div className="stat-context"><span className="badge fair">1 needs review</span></div>
                                </div>
                            </div>

                            {/* Main content grid */}
                            <div className="main-grid" style={{ marginBottom: '24px' }}>
                                {/* Where listeners are */}
                                <div className="card">
                                    <div className="card-header">
                                        <div>
                                            <div className="card-title">Where your listeners are</div>
                                            <div className="card-subtitle">Top markets by streams</div>
                                        </div>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                                            {[
                                                { city: 'London', country: 'UK', pct: 18, streams: '89K' },
                                                { city: 'Los Angeles', country: 'US', pct: 14, streams: '68K' },
                                                { city: 'Berlin', country: 'DE', pct: 11, streams: '54K' },
                                                { city: 'Sydney', country: 'AU', pct: 8, streams: '39K' },
                                                { city: 'Toronto', country: 'CA', pct: 7, streams: '34K' }
                                            ].map((loc, i) => (
                                                <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                                    <div style={{ width: '24px', fontFamily: "'IBM Plex Mono', monospace", fontSize: '11px', color: 'var(--text-tertiary)' }}>{i + 1}</div>
                                                    <div style={{ flex: 1 }}>
                                                        <div style={{ fontSize: '13px', fontWeight: '500' }}>{loc.city}</div>
                                                        <div style={{ fontSize: '11px', color: 'var(--text-tertiary)' }}>{loc.country}</div>
                                                    </div>
                                                    <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '12px', color: 'var(--text-secondary)' }}>{loc.streams}</div>
                                                    <div style={{ width: '60px', height: '4px', background: 'var(--border)', borderRadius: '2px', overflow: 'hidden' }}>
                                                        <div style={{ width: `${loc.pct * 5}%`, height: '100%', background: 'var(--accent)', borderRadius: '2px' }} />
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                {/* Revenue by source */}
                                <div className="card">
                                    <div className="card-header">
                                        <div>
                                            <div className="card-title">Revenue breakdown</div>
                                            <div className="card-subtitle">By source this month</div>
                                        </div>
                                    </div>
                                    <div className="card-content">
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                                            {[
                                                { source: 'Streaming', amount: 6200, pct: 52, color: 'var(--accent)' },
                                                { source: 'Sync licensing', amount: 3500, pct: 29, color: 'var(--positive)' },
                                                { source: 'Publishing', amount: 1400, pct: 12, color: 'var(--text-secondary)' },
                                                { source: 'Other', amount: 800, pct: 7, color: 'var(--border)' }
                                            ].map((src, i) => (
                                                <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                                    <div style={{ width: '8px', height: '8px', borderRadius: '2px', background: src.color, flexShrink: 0 }} />
                                                    <div style={{ flex: 1, fontSize: '13px' }}>{src.source}</div>
                                                    <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '12px', marginRight: '8px' }}>${(src.amount / 1000).toFixed(1)}K</div>
                                                    <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '11px', color: 'var(--text-tertiary)', width: '32px', textAlign: 'right' }}>{src.pct}%</div>
                                                </div>
                                            ))}
                                        </div>
                                        <div style={{ marginTop: '16px', padding: '12px', background: 'var(--positive-light)', borderRadius: '6px', fontSize: '12px', color: 'var(--positive)' }}>
                                            <strong>Sync is your fastest growing source</strong> — up 34% from last month
                                        </div>
                                    </div>
                                </div>

                                {/* Insights carousel */}
                                <div className="card" style={{ background: 'var(--text-primary)', color: 'var(--bg-primary)', border: 'none', position: 'relative', overflow: 'hidden', display: 'flex', flexDirection: 'column' }}>
                                    <div className="card-content" style={{ padding: '24px', flex: 1, display: 'flex', flexDirection: 'column' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
                                            <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', letterSpacing: '1px', opacity: 0.5 }}>
                                                {insights[insightIndex].label}
                                            </div>
                                            <div style={{ display: 'flex', gap: '4px' }}>
                                                <button
                                                    onClick={prevInsight}
                                                    style={{
                                                        width: '28px',
                                                        height: '28px',
                                                        borderRadius: '4px',
                                                        border: 'none',
                                                        background: 'rgba(255,255,255,0.15)',
                                                        color: 'var(--bg-primary)',
                                                        cursor: 'pointer',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center'
                                                    }}
                                                    aria-label="Previous insight"
                                                >
                                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="15 18 9 12 15 6"/></svg>
                                                </button>
                                                <button
                                                    onClick={nextInsight}
                                                    style={{
                                                        width: '28px',
                                                        height: '28px',
                                                        borderRadius: '4px',
                                                        border: 'none',
                                                        background: 'rgba(255,255,255,0.15)',
                                                        color: 'var(--bg-primary)',
                                                        cursor: 'pointer',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center'
                                                    }}
                                                    aria-label="Next insight"
                                                >
                                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"/></svg>
                                                </button>
                                            </div>
                                        </div>
                                        <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '28px', marginBottom: '16px', lineHeight: 1.2 }}>
                                            {insights[insightIndex].title}
                                        </div>
                                        <div style={{ fontSize: '15px', opacity: 0.75, lineHeight: 1.6, flex: 1 }}>
                                            {insights[insightIndex].body}
                                        </div>
                                        <div style={{ marginTop: '20px' }}>
                                            <button
                                                className="btn"
                                                style={{ background: 'var(--bg-primary)', color: 'var(--text-primary)', border: 'none' }}
                                                onClick={() => {
                                                    if (insights[insightIndex].action === 'rates') {
                                                        handleTabChange('tools');
                                                        setActiveTool('ratecheck');
                                                    } else {
                                                        handleTabChange('intel');
                                                    }
                                                }}
                                            >
                                                {insights[insightIndex].cta}
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* Contracts needing attention */}
                                <div className="card">
                                    <div className="card-header">
                                        <div>
                                            <div className="card-title">Contracts</div>
                                            <div className="card-subtitle">Review status</div>
                                        </div>
                                        <button className="btn btn-sm" onClick={() => handleTabChange('contracts')}>View all</button>
                                    </div>
                                    <div className="card-content">
                                        <div className="contract-list">
                                            {dashboardData.contracts.map((c, i) => (
                                                <div key={i} className="contract-item">
                                                    <div className="contract-info">
                                                        <div className="contract-name">{c.name}</div>
                                                        <div className="contract-meta">{c.type}</div>
                                                    </div>
                                                    <div className="contract-health">
                                                        <div className={`contract-health-fill ${c.health >= 80 ? 'good' : c.health >= 60 ? 'fair' : 'poor'}`} style={{ width: `${c.health}%` }} />
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Tool cards */}
                            <div style={{ marginBottom: '24px' }}>
                                <div style={{ fontSize: '13px', fontWeight: '600', marginBottom: '12px', color: 'var(--text-secondary)' }}>Tools</div>
                                <div className="tools-grid" style={{ marginBottom: 0 }}>
                                    <div className="tool-card" onClick={() => { handleTabChange('tools'); setActiveTool('scanner'); }}>
                                        <div className="tool-icon scanner">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>
                                        </div>
                                        <div className="tool-name">Scan a contract</div>
                                        <div className="tool-desc">Identify red flags and get negotiation language</div>
                                    </div>
                                    <div className="tool-card" onClick={() => { handleTabChange('tools'); setActiveTool('simulator'); }}>
                                        <div className="tool-icon simulator">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>
                                        </div>
                                        <div className="tool-name">Model a deal</div>
                                        <div className="tool-desc">See how terms affect your long-term earnings</div>
                                    </div>
                                    <div className="tool-card" onClick={() => { handleTabChange('tools'); setActiveTool('ratecheck'); }}>
                                        <div className="tool-icon ratecheck">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4 12 14.01l-3-3"/></svg>
                                        </div>
                                        <div className="tool-name">Check your rate</div>
                                        <div className="tool-desc">Compare your deal to similar artists</div>
                                    </div>
                                </div>
                            </div>

                            {/* Bottom row: Community + Contribute */}
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                                {/* Community pulse */}
                                <div style={{
                                    background: 'var(--bg-secondary)',
                                    border: '1px solid var(--border)',
                                    borderRadius: '8px',
                                    padding: '20px',
                                    cursor: 'pointer'
                                }} onClick={() => handleTabChange('intel')}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>
                                        <div style={{ fontSize: '14px', fontWeight: '600' }}>Community intel</div>
                                        <div style={{ fontSize: '12px', color: 'var(--text-tertiary)' }}>View all →</div>
                                    </div>
                                    <div style={{ fontSize: '13px', color: 'var(--text-secondary)', lineHeight: 1.5 }}>
                                        <strong style={{ color: 'var(--text-primary)' }}>12 new deals</strong> shared this week. See what artists at your level are signing.
                                    </div>
                                </div>

                                {/* Contribute CTA */}
                                {!contributed ? (
                                    <div style={{
                                        background: 'var(--text-primary)',
                                        color: 'var(--bg-primary)',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        cursor: 'pointer'
                                    }} onClick={() => setShowContribute(true)}>
                                        <div style={{ fontSize: '14px', fontWeight: '600', marginBottom: '8px' }}>Help build benchmarks</div>
                                        <div style={{ fontSize: '13px', opacity: 0.7, lineHeight: 1.5 }}>
                                            Anonymously share your rates to strengthen data for everyone.
                                        </div>
                                    </div>
                                ) : (
                                    <div style={{
                                        background: 'var(--positive-light)',
                                        border: '1px solid var(--positive)',
                                        borderRadius: '8px',
                                        padding: '20px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '12px'
                                    }}>
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--positive)" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>
                                        <div>
                                            <div style={{ fontSize: '14px', fontWeight: '600', color: 'var(--positive)' }}>Data contributed</div>
                                            <div style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>Helping 2,847+ artists</div>
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Contribute modal */}
                            {showContribute && !contributed && (
                                <div style={{
                                    position: 'fixed',
                                    top: 0, left: 0, right: 0, bottom: 0,
                                    background: 'rgba(0,0,0,0.5)',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    zIndex: 1000,
                                    padding: '20px'
                                }} onClick={() => setShowContribute(false)}>
                                    <div style={{
                                        background: 'var(--bg-secondary)',
                                        borderRadius: '12px',
                                        padding: '32px',
                                        maxWidth: '480px',
                                        width: '100%'
                                    }} onClick={e => e.stopPropagation()}>
                                        <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '24px', marginBottom: '12px' }}>Share your data</div>
                                        <p style={{ fontSize: '14px', color: 'var(--text-secondary)', marginBottom: '24px', lineHeight: 1.6 }}>
                                            This is anonymized and aggregated. No personal info is stored.
                                        </p>
                                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '12px', marginBottom: '24px' }}>
                                            <div style={{ padding: '16px', background: 'var(--bg-primary)', borderRadius: '8px' }}>
                                                <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', color: 'var(--text-tertiary)', marginBottom: '6px' }}>STREAM RATE</div>
                                                <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '20px' }}>${dashboardData.streamRate.toFixed(4)}</div>
                                            </div>
                                            <div style={{ padding: '16px', background: 'var(--bg-primary)', borderRadius: '8px' }}>
                                                <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', color: 'var(--text-tertiary)', marginBottom: '6px' }}>TAKE RATE</div>
                                                <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '20px' }}>{dashboardData.takeRate}%</div>
                                            </div>
                                        </div>
                                        <div style={{ display: 'flex', gap: '12px' }}>
                                            <button className="btn btn-primary" style={{ flex: 1 }} onClick={() => { setContributed(true); setShowContribute(false); }}>Contribute</button>
                                            <button className="btn" onClick={() => setShowContribute(false)}>Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </>
                    )}

                    {/* CONTRACTS TAB */}
                    {activeTab === 'contracts' && (
                        <div className="main-grid">
                            <div className="card" style={{ gridColumn: 'span 2' }}>
                                <div className="card-header"><div><div className="card-title">All contracts</div></div><button className="btn btn-sm" style={{ opacity: 0.5, cursor: 'not-allowed' }} disabled title="Coming soon">+ Add</button></div>
                                <div className="card-content">
                                    <div className="contract-list">
                                        {[...dashboardData.contracts, { name: 'Spotify Editorial', type: 'Playlist', value: 0, health: 75 }, { name: 'Merch Partner', type: 'Rev share', value: null, health: 58 }].map((c, i) => (
                                            <div key={i} className="contract-item">
                                                <div className="contract-info"><div className="contract-name">{c.name}</div><div className="contract-meta">{c.type}</div></div>
                                                <div className="contract-value">{c.value ? `$${(c.value/1000)}K` : 'Rev share'}</div>
                                                <div className="contract-health"><div className={`contract-health-fill ${c.health >= 80 ? 'good' : c.health >= 60 ? 'fair' : 'poor'}`} style={{ width: `${c.health}%` }} /></div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* TOOLS TAB */}
                    {activeTab === 'tools' && !activeTool && (
                        <>
                            <div className="page-intro">
                                <h2 className="page-title">Tools</h2>
                                <p className="page-subtitle">Analyze contracts, model scenarios, and benchmark your deals.</p>
                            </div>
                            <div className="tools-grid">
                                <div className="tool-card" onClick={() => setActiveTool('scanner')}>
                                    <div className="tool-icon scanner">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>
                                    </div>
                                    <div className="tool-name">Contract scanner</div>
                                    <div className="tool-desc">Paste contract text to identify red flags and compare against industry benchmarks.</div>
                                </div>
                                <div className="tool-card" onClick={() => setActiveTool('simulator')}>
                                    <div className="tool-icon simulator">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>
                                    </div>
                                    <div className="tool-name">Deal simulator</div>
                                    <div className="tool-desc">Model different deal structures and see how changes affect your long-term earnings.</div>
                                </div>
                                <div className="tool-card" onClick={() => setActiveTool('ratecheck')}>
                                    <div className="tool-icon ratecheck">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4 12 14.01l-3-3"/></svg>
                                    </div>
                                    <div className="tool-name">Rate check</div>
                                    <div className="tool-desc">Answer 6 questions to see how your deal compares to artists at your level.</div>
                                </div>
                            </div>
                        </>
                    )}

                    {/* SCANNER TOOL */}
                    {activeTab === 'tools' && activeTool === 'scanner' && (
                        <>
                            <div className="page-intro">
                                <button className="btn btn-sm" onClick={() => setActiveTool(null)} style={{ marginBottom: '12px' }}>← Back to tools</button>
                                <h2 className="page-title">Contract scanner</h2>
                                <p className="page-subtitle">Paste contract text to identify problematic clauses and compare against industry benchmarks.</p>
                            </div>
                            <div className="scanner-grid">
                                <div>
                                    <div style={{ marginBottom: '12px', display: 'flex', gap: '8px' }}>
                                        <button className="btn btn-sm" onClick={loadSampleContract}>Load sample contract</button>
                                        <button className="btn btn-primary btn-sm" onClick={scanContract} disabled={!contractText.trim() || scanning}>
                                            {scanning ? 'Scanning...' : 'Scan for red flags'}
                                        </button>
                                    </div>
                                    <textarea className="contract-input" placeholder="Paste your contract text here..." value={contractText} onChange={(e) => setContractText(e.target.value)} />
                                </div>
                                <div>
                                    {scanResults && (
                                        <>
                                            <div className="scan-summary">
                                                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>
                                                    <div style={{ textAlign: 'center', minWidth: '80px' }}>
                                                        <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '48px', lineHeight: 1, color: scanResults.score >= 60 ? 'var(--positive)' : scanResults.score >= 40 ? 'var(--accent)' : 'var(--negative)' }}>
                                                            {scanResults.score}
                                                        </div>
                                                        <div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', color: 'var(--text-tertiary)', marginTop: '4px' }}>/ 100</div>
                                                    </div>
                                                    <div>
                                                        <div style={{ fontWeight: 600, fontSize: '16px' }}>Contract health</div>
                                                        <div style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>
                                                            {scanResults.score >= 60 ? 'Reasonable terms with minor issues' : scanResults.score >= 40 ? 'Several concerning clauses to address' : 'High risk - significant red flags found'}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div className="scan-summary-grid">
                                                    <div className="summary-stat">
                                                        <div className="summary-stat-value" style={{ color: 'var(--negative)' }}>{scanResults.flags.filter(f => f.severity === 'critical').length}</div>
                                                        <div className="summary-stat-label">Critical issues</div>
                                                    </div>
                                                    <div className="summary-stat">
                                                        <div className="summary-stat-value" style={{ color: 'var(--accent)' }}>{scanResults.flags.filter(f => f.severity === 'warning').length}</div>
                                                        <div className="summary-stat-label">Warnings</div>
                                                    </div>
                                                    <div className="summary-stat">
                                                        <div className="summary-stat-value" style={{ color: 'var(--text-secondary)' }}>{scanResults.flags.length}</div>
                                                        <div className="summary-stat-label">Total flags</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </>
                                    )}
                                    <div className="flags-list">
                                        {!scanResults && <div style={{ padding: '40px', textAlign: 'center', color: 'var(--text-tertiary)' }}>Load a sample or paste contract text to analyze</div>}
                                        {scanResults?.flags.map((flag, i) => (
                                            <div key={i} className="flag-item">
                                                <div className="flag-header">
                                                    <div className={`flag-severity ${flag.severity}`} />
                                                    <span className={`badge ${flag.severity}`}>{flag.severity}</span>
                                                    <span className="flag-title">{flag.title}</span>
                                                </div>
                                                <div className="flag-clause">{flag.clause}</div>
                                                <div className="flag-explanation">{flag.explanation}</div>
                                                <div className="flag-benchmark"><strong>Industry benchmark:</strong> {flag.benchmark}</div>
                                                <div className="flag-action">
                                                    <strong>Negotiate:</strong> {flag.action}
                                                    {flag.template && (
                                                        <>
                                                            <div className="flag-template">"{flag.template}"</div>
                                                            <div className="flag-copy" onClick={() => { navigator.clipboard.writeText(flag.template); }}>
                                                                Copy to clipboard →
                                                            </div>
                                                        </>
                                                    )}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </>
                    )}

                    {/* SIMULATOR TOOL */}
                    {activeTab === 'tools' && activeTool === 'simulator' && (
                        <>
                            <div className="page-intro">
                                <button className="btn btn-sm" onClick={() => setActiveTool(null)} style={{ marginBottom: '12px' }}>← Back to tools</button>
                                <h2 className="page-title">Deal simulator</h2>
                                <p className="page-subtitle">Model different deal structures and see the long-term impact on your earnings.</p>
                            </div>
                            <div className="sim-grid">
                                <div className="card">
                                    <div className="card-header"><div><div className="card-title">Deal parameters</div></div></div>
                                    <div className="card-content">
                                        <div className="slider-group">
                                            <div className="slider-header"><span className="slider-label">Monthly streams</span><span className="slider-value">{(streams/1000).toFixed(0)}K</span></div>
                                            <input type="range" className="slider" min="10000" max="5000000" step="10000" value={streams} onChange={(e) => setStreams(Number(e.target.value))} />
                                        </div>
                                        <div className="slider-group">
                                            <div className="slider-header"><span className="slider-label">Per-stream rate</span><span className="slider-value">${rate.toFixed(4)}</span></div>
                                            <input type="range" className="slider" min="0.001" max="0.008" step="0.0001" value={rate} onChange={(e) => setRate(Number(e.target.value))} />
                                            <div className="slider-hint">Industry avg: $0.003-0.004</div>
                                        </div>
                                        <div className="slider-group">
                                            <div className="slider-header"><span className="slider-label">Distributor cut</span><span className="slider-value">{distCut}%</span></div>
                                            <input type="range" className="slider" min="0" max="50" value={distCut} onChange={(e) => setDistCut(Number(e.target.value))} />
                                            <div className="slider-hint">DistroKid: 0%, CD Baby: 9%</div>
                                        </div>
                                        <div className="slider-group">
                                            <div className="slider-header"><span className="slider-label">Your publishing %</span><span className="slider-value">{pubShare}%</span></div>
                                            <input type="range" className="slider" min="0" max="100" step="5" value={pubShare} onChange={(e) => setPubShare(Number(e.target.value))} />
                                        </div>
                                        <div className="slider-group">
                                            <div className="slider-header"><span className="slider-label">Contract term</span><span className="slider-value">{termYears} years</span></div>
                                            <input type="range" className="slider" min="1" max="10" value={termYears} onChange={(e) => setTermYears(Number(e.target.value))} />
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div className="result-card">
                                        <div className="result-label">Your yearly net (current)</div>
                                        <div className="result-value">{formatCurrency(simCalcs.currentNet)}</div>
                                    </div>
                                    <div className="card" style={{ marginBottom: '16px', padding: '16px', background: 'var(--accent-light)', border: '1px solid rgba(201, 68, 42, 0.2)' }}>
                                        <div style={{ fontSize: '13px', fontWeight: 600, marginBottom: '12px', color: 'var(--accent)' }}>What if you negotiated better?</div>
                                        <div className="slider-group" style={{ marginBottom: '12px' }}>
                                            <div className="slider-header"><span className="slider-label">Distributor cut</span><span className="slider-value" style={{ color: 'var(--positive)' }}>{altDistCut}%</span></div>
                                            <input type="range" className="slider" min="0" max="50" value={altDistCut} onChange={(e) => setAltDistCut(Number(e.target.value))} />
                                        </div>
                                        <div className="slider-group" style={{ marginBottom: 0 }}>
                                            <div className="slider-header"><span className="slider-label">Your publishing %</span><span className="slider-value" style={{ color: 'var(--positive)' }}>{altPubShare}%</span></div>
                                            <input type="range" className="slider" min="0" max="100" step="5" value={altPubShare} onChange={(e) => setAltPubShare(Number(e.target.value))} />
                                        </div>
                                    </div>
                                    <div className="result-card">
                                        <div className="result-label">Your yearly net (alternative)</div>
                                        <div className="result-value" style={{ color: simCalcs.altNet > simCalcs.currentNet ? 'var(--positive)' : simCalcs.altNet < simCalcs.currentNet ? 'var(--negative)' : 'inherit' }}>{formatCurrency(simCalcs.altNet)}</div>
                                    </div>
                                    <div style={{ padding: '20px', background: simCalcs.isGain ? 'var(--positive-light)' : 'var(--negative-light)', borderRadius: '8px', textAlign: 'center' }}>
                                        <div style={{ fontSize: '12px', color: 'var(--text-secondary)', marginBottom: '4px' }}>
                                            {simCalcs.isGain ? `Extra earnings over ${termYears} years` : `You'd lose over ${termYears} years`}
                                        </div>
                                        <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '36px', color: simCalcs.isGain ? 'var(--positive)' : 'var(--negative)' }}>
                                            {simCalcs.isGain ? '+' : '-'}{formatCurrency(simCalcs.diff)}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </>
                    )}

                    {/* INTEL TAB */}
                    {activeTab === 'intel' && (
                        <>
                            <div className="page-intro">
                                <h2 className="page-title">Community intel</h2>
                                <p className="page-subtitle">Anonymous deal insights from artists like you. See what others got—and how.</p>
                            </div>
                            <div className="stats-row">
                                <div className="stat-card" style={{ textAlign: 'center' }}><div className="stat-value">2,847</div><div className="stat-label">Deals shared</div></div>
                                <div className="stat-card" style={{ textAlign: 'center' }}><div className="stat-value">$4.2M</div><div className="stat-label">Total value</div></div>
                                <div className="stat-card" style={{ textAlign: 'center' }}><div className="stat-value">+18%</div><div className="stat-label">Avg negotiation win</div></div>
                            </div>
                            <div className="intel-filters">
                                {['all', 'sync', 'distribution', 'brand'].map(f => (
                                    <button key={f} className={`filter-btn ${intelFilter === f ? 'active' : ''}`} onClick={() => setIntelFilter(f)} style={{ textTransform: 'capitalize' }}>{f === 'all' ? 'All deals' : f}</button>
                                ))}
                            </div>
                            <div className="deal-feed">
                                {communityDeals.filter(d => intelFilter === 'all' || d.type === intelFilter).map(deal => (
                                    <div key={deal.id} className="deal-card">
                                        <div className="deal-header">
                                            <span className={`deal-type ${deal.type}`}>{deal.type}</span>
                                            <span style={{ fontSize: '11px', color: 'var(--text-tertiary)' }}>{deal.time}</span>
                                        </div>
                                        <div className="deal-title">{deal.title}</div>
                                        <div className="deal-details">
                                            <div className="detail-item"><div className="detail-value">{deal.value ? `$${deal.value.toLocaleString()}` : '—'}</div><div className="detail-label">Value</div></div>
                                            <div className="detail-item"><div className="detail-value">{deal.term}</div><div className="detail-label">Term</div></div>
                                            <div className="detail-item"><div className="detail-value">{deal.tier}</div><div className="detail-label">Tier</div></div>
                                            <div className="detail-item"><div className="detail-value">{deal.win}</div><div className="detail-label">Win</div></div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </>
                    )}

                    {/* RATE CHECK TOOL */}
                    {activeTab === 'tools' && activeTool === 'ratecheck' && (
                        <>
                            <button className="btn btn-sm" onClick={() => { setActiveTool(null); setRcStep(-1); setRcAnswers({}); setRcCurrentValue(''); }} style={{ marginBottom: '16px' }}>← Back to tools</button>
                            <div className="ratecheck-container">
                            {rcStep === -1 && (
                                <div style={{ textAlign: 'center', padding: '20px 0 60px' }}>
                                    <div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: 'clamp(48px, 12vw, 72px)', lineHeight: 1.05, letterSpacing: '-2px', marginBottom: '24px' }}>How's your deal?</div>
                                    <p style={{ fontSize: '16px', color: 'var(--text-secondary)', maxWidth: '420px', margin: '0 auto 40px', lineHeight: 1.6 }}>Answer 6 quick questions and get personalized insights based on real data from 10,000+ artists.</p>
                                    <div style={{ display: 'flex', justifyContent: 'center', gap: '48px', marginBottom: '48px' }}>
                                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '32px' }}>10K+</div><div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', letterSpacing: '1px', color: 'var(--text-tertiary)', marginTop: '4px' }}>ARTISTS COMPARED</div></div>
                                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '32px' }}>6</div><div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', letterSpacing: '1px', color: 'var(--text-tertiary)', marginTop: '4px' }}>QUESTIONS</div></div>
                                        <div style={{ textAlign: 'center' }}><div style={{ fontFamily: "'Instrument Serif', Georgia, serif", fontSize: '32px' }}>2m</div><div style={{ fontFamily: "'IBM Plex Mono', monospace", fontSize: '10px', letterSpacing: '1px', color: 'var(--text-tertiary)', marginTop: '4px' }}>TO COMPLETE</div></div>
                                    </div>
                                    <button className="btn btn-primary" style={{ padding: '14px 32px' }} onClick={handleRcNext}>Start assessment</button>
                                </div>
                            )}

                            {rcStep >= 0 && rcStep < rcQuestions.length && (
                                <div key={rcStep}>
                                    <div className="ratecheck-progress">
                                        {rcQuestions.map((_, i) => (
                                            <div key={i} className={`ratecheck-dot ${i === rcStep ? 'active' : ''} ${i < rcStep ? 'completed' : ''}`} />
                                        ))}
                                    </div>
                                    <div className="question-category">{rcQuestions[rcStep].category}</div>
                                    <div className="question-text">{rcQuestions[rcStep].question}</div>

                                    {rcQuestions[rcStep].type === 'choice' && (
                                        <div className={`choices-grid ${rcQuestions[rcStep].columns === 1 ? 'single' : ''}`}>
                                            {rcQuestions[rcStep].choices.map(c => (
                                                <div key={c.value} className={`choice-card ${rcCurrentValue === c.value ? 'selected' : ''}`} onClick={() => setRcCurrentValue(c.value)}>
                                                    <div className="choice-card-text">{c.label}</div>
                                                    <div className="choice-card-sub">{c.sub}</div>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    {rcQuestions[rcStep].type === 'slider' && (
                                        <div className="rc-slider-container">
                                            <div className="rc-slider-display">{formatRcValue(rcCurrentValue || rcQuestions[rcStep].default, rcQuestions[rcStep].format)}</div>
                                            <div className="rc-slider-track">
                                                <div className="rc-slider-fill" style={{ width: `${((rcCurrentValue || rcQuestions[rcStep].default) - rcQuestions[rcStep].min) / (rcQuestions[rcStep].max - rcQuestions[rcStep].min) * 100}%` }} />
                                            </div>
                                            <input type="range" className="rc-slider" min={rcQuestions[rcStep].min} max={rcQuestions[rcStep].max} step={rcQuestions[rcStep].step} value={rcCurrentValue || rcQuestions[rcStep].default} onChange={(e) => setRcCurrentValue(parseFloat(e.target.value))} />
                                            <div className="rc-slider-labels">
                                                <span>{formatRcValue(rcQuestions[rcStep].min, rcQuestions[rcStep].format)}</span>
                                                <span>{formatRcValue(rcQuestions[rcStep].max, rcQuestions[rcStep].format)}</span>
                                            </div>
                                            {rcQuestions[rcStep].benchmark && (
                                                <div className="rc-slider-benchmark">{rcQuestions[rcStep].benchmark.label}: {formatRcValue(rcQuestions[rcStep].benchmark.value, rcQuestions[rcStep].format)}</div>
                                            )}
                                        </div>
                                    )}

                                    {rcQuestions[rcStep].hint && <div className="rc-hint">{rcQuestions[rcStep].hint}</div>}

                                    <button className="btn btn-primary" onClick={handleRcNext} disabled={rcCurrentValue === '' && rcQuestions[rcStep].type === 'choice'} style={{ marginTop: '24px' }}>
                                        {rcStep === rcQuestions.length - 1 ? 'See my score' : 'Continue'}
                                    </button>
                                </div>
                            )}

                            {rcStep >= rcQuestions.length && (
                                <div className="rc-results">
                                    <div className="rc-score">{calculateRcScore().score}</div>
                                    <div className={`rc-grade ${getRcGrade(calculateRcScore().score).cls}`}>{getRcGrade(calculateRcScore().score).label}</div>
                                    <p className="rc-summary">
                                        {calculateRcScore().score >= 70 ? "You're in a strong position. A few optimizations could push you further." : calculateRcScore().score >= 50 ? "You're doing okay, but there's meaningful room for improvement." : "There are several areas where you might be leaving money on the table."}
                                    </p>

                                    <div className="rc-results-grid">
                                        {rcAnswers.streamRate && (
                                            <div className="rc-result-card">
                                                <div className="rc-result-label">Per-stream rate</div>
                                                <div className="rc-result-value">${rcAnswers.streamRate.toFixed(4)}</div>
                                                <div className="rc-result-context">Median: $0.0033</div>
                                            </div>
                                        )}
                                        {rcAnswers.distributorCut !== undefined && (
                                            <div className="rc-result-card">
                                                <div className="rc-result-label">Distributor cut</div>
                                                <div className="rc-result-value">{rcAnswers.distributorCut}%</div>
                                                <div className="rc-result-context">Best: 10-12%</div>
                                            </div>
                                        )}
                                        {rcAnswers.monthlyRevenue && (
                                            <div className="rc-result-card">
                                                <div className="rc-result-label">Monthly revenue</div>
                                                <div className="rc-result-value">${rcAnswers.monthlyRevenue.toLocaleString()}</div>
                                                <div className="rc-result-context">For your tier</div>
                                            </div>
                                        )}
                                        {rcAnswers.ownsMasters && (
                                            <div className="rc-result-card">
                                                <div className="rc-result-label">Masters</div>
                                                <div className="rc-result-value">{rcAnswers.ownsMasters === 'yes' ? '100%' : rcAnswers.ownsMasters === 'partial' ? 'Split' : '0%'}</div>
                                                <div className="rc-result-context">Ownership = wealth</div>
                                            </div>
                                        )}
                                    </div>

                                    {calculateRcScore().insights.length > 0 && (
                                        <div className="rc-insight">
                                            <div className="rc-insight-title">Key insight</div>
                                            <div className="rc-insight-text">{calculateRcScore().insights[0]}</div>
                                        </div>
                                    )}

                                    <button className="btn" onClick={() => { setRcStep(-1); setRcAnswers({}); setRcCurrentValue(''); }} style={{ marginTop: '16px' }}>Retake assessment</button>
                                </div>
                            )}
                            </div>
                        </>
                    )}

                    {/* WRAPPED TAB */}
                    {activeTab === 'wrapped' && (
                        <div className="wrapped-container">
                            <div className="wrapped-left">
                                <div className="wrapped-progress">
                                    {Array.from({ length: 7 }).map((_, i) => (
                                        <div key={i} className={`wrapped-segment ${i <= wrappedSlide ? 'active' : ''}`} />
                                    ))}
                                </div>

                                <div className="wrapped-slide-content">
                                    {wrappedSlide === 0 && (
                                        <>
                                            <div className="wrapped-label">Your year in review</div>
                                            <div className="wrapped-title">See what you accomplished with CEO in {wrappedData.year}.</div>
                                            <div className="wrapped-context">Step through your highlights from this year.</div>
                                        </>
                                    )}

                                    {wrappedSlide === 1 && (
                                        <>
                                            <div className="wrapped-label">Due diligence</div>
                                            <div className="wrapped-title">Every deal analyzed. Every clause scrutinized.</div>
                                            <div className="wrapped-context">You reviewed {wrappedData.contractsReviewed} contracts this year. Knowledge is leverage.</div>
                                        </>
                                    )}

                                    {wrappedSlide === 2 && (
                                        <>
                                            <div className="wrapped-label">Dodged bullets</div>
                                            <div className="wrapped-title">Sometimes the best deal is the one you don't take.</div>
                                            <div className="wrapped-context">You walked away from {wrappedData.dealsDodged} below-market offers that didn't serve you.</div>
                                        </>
                                    )}

                                    {wrappedSlide === 3 && (
                                        <>
                                            <div className="wrapped-label">Money talks</div>
                                            <div className="wrapped-title">This is what transparency gets you.</div>
                                            <div className="wrapped-context">By negotiating with real benchmark data, you kept more of what you earned.</div>
                                        </>
                                    )}

                                    {wrappedSlide === 4 && (
                                        <>
                                            <div className="wrapped-label">Biggest win</div>
                                            <div className="wrapped-title">{wrappedData.topWin}</div>
                                            <div className="wrapped-context">${wrappedData.topWinAmount.toLocaleString()} above market rate. That deal alone was worth it.</div>
                                        </>
                                    )}

                                    {wrappedSlide === 5 && (
                                        <>
                                            <div className="wrapped-label">Always comparing</div>
                                            <div className="wrapped-title">You checked before deciding. Every time.</div>
                                            <div className="wrapped-context">{wrappedData.benchmarksChecked} benchmark comparisons. That's an informed artist.</div>
                                        </>
                                    )}

                                    {wrappedSlide === 6 && (
                                        <>
                                            <div className="wrapped-label">2024 complete</div>
                                            <div className="wrapped-title">Here's to negotiating from a position of knowledge.</div>
                                            <div className="wrapped-context">Top {wrappedData.percentile}% of indie artists at your level. Keep going.</div>
                                        </>
                                    )}
                                </div>

                                <div className="wrapped-nav-buttons">
                                    {wrappedSlide === 0 && (
                                        <button className="btn btn-primary" onClick={() => setWrappedSlide(1)}>
                                            Start →
                                        </button>
                                    )}

                                    {wrappedSlide >= 1 && wrappedSlide <= 5 && (
                                        <>
                                            <button className="btn" onClick={() => setWrappedSlide(s => s - 1)}>
                                                ← Back
                                            </button>
                                            <button className="btn btn-primary" onClick={() => setWrappedSlide(s => s + 1)}>
                                                Next →
                                            </button>
                                        </>
                                    )}

                                    {wrappedSlide === 6 && (
                                        <>
                                            <button className="btn btn-primary" style={{ display: 'inline-flex', alignItems: 'center', gap: '8px' }} onClick={() => {
                                                // Instagram Stories: 1080x1920 (9:16)
                                                const canvas = document.createElement('canvas');
                                                canvas.width = 1080;
                                                canvas.height = 1920;
                                                const ctx = canvas.getContext('2d');

                                                // Base teal background - exact match to app
                                                ctx.fillStyle = '#2d5a5a';
                                                ctx.fillRect(0, 0, 1080, 1920);

                                                // Atmospheric gradients like the app's ::before
                                                const grad1 = ctx.createRadialGradient(320, 380, 0, 320, 380, 800);
                                                grad1.addColorStop(0, 'rgba(255, 255, 255, 0.1)');
                                                grad1.addColorStop(1, 'transparent');
                                                ctx.fillStyle = grad1;
                                                ctx.fillRect(0, 0, 1080, 1920);

                                                const grad2 = ctx.createRadialGradient(760, 1540, 0, 760, 1540, 800);
                                                grad2.addColorStop(0, 'rgba(0, 0, 0, 0.2)');
                                                grad2.addColorStop(1, 'transparent');
                                                ctx.fillStyle = grad2;
                                                ctx.fillRect(0, 0, 1080, 1920);

                                                // Blur orbs (simulate the floating blur effect)
                                                ctx.fillStyle = 'rgba(255, 255, 255, 0.06)';
                                                ctx.beginPath();
                                                ctx.arc(280, 600, 200, 0, Math.PI * 2);
                                                ctx.fill();
                                                ctx.beginPath();
                                                ctx.arc(800, 1400, 250, 0, Math.PI * 2);
                                                ctx.fill();

                                                // Floating fragments - recreate the app's texture
                                                const fragments = [
                                                    { text: `${wrappedData.contractsReviewed} scanned`, x: 120, y: 280, highlight: true },
                                                    { text: 'Masters: 100%', x: 780, y: 420, highlight: false },
                                                    { text: `+$${(wrappedData.topWinAmount/1000).toFixed(1)}K sync`, x: 140, y: 580, highlight: true },
                                                    { text: 'No perpetuity', x: 820, y: 720, highlight: false },
                                                    { text: `${wrappedData.benchmarksChecked} checks`, x: 100, y: 1320, highlight: false },
                                                    { text: '3yr terms', x: 860, y: 1180, highlight: false },
                                                    { text: 'Full audit rights', x: 160, y: 1520, highlight: false },
                                                    { text: `Top ${wrappedData.percentile}%`, x: 800, y: 1620, highlight: true },
                                                ];

                                                fragments.forEach(f => {
                                                    // Fragment background
                                                    ctx.font = '500 22px monospace';
                                                    const textWidth = ctx.measureText(f.text).width;
                                                    ctx.fillStyle = f.highlight ? 'rgba(255, 255, 255, 0.12)' : 'rgba(255, 255, 255, 0.06)';
                                                    ctx.beginPath();
                                                    ctx.roundRect(f.x - 16, f.y - 28, textWidth + 32, 44, 6);
                                                    ctx.fill();

                                                    // Fragment text
                                                    ctx.fillStyle = f.highlight ? 'rgba(255, 255, 255, 0.7)' : 'rgba(255, 255, 255, 0.4)';
                                                    ctx.font = f.highlight ? '600 24px monospace' : '500 22px monospace';
                                                    ctx.textAlign = 'left';
                                                    ctx.fillText(f.text, f.x, f.y);
                                                });

                                                // Main hero stat - centered, massive
                                                ctx.textAlign = 'center';
                                                ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
                                                ctx.font = 'normal 280px Georgia, serif';
                                                ctx.fillText(`$${(wrappedData.moneySaved/1000).toFixed(0)}K`, 540, 980);

                                                // Label beneath
                                                ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
                                                ctx.font = '500 24px monospace';
                                                ctx.fillText('SAVED', 540, 1060);

                                                // CEO branding - top
                                                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                                                ctx.font = 'normal 48px Georgia, serif';
                                                ctx.fillText('CEO', 540, 120);

                                                // Year - bottom
                                                ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
                                                ctx.font = '500 28px monospace';
                                                ctx.fillText('2024', 540, 1820);

                                                // Download as high quality PNG
                                                const link = document.createElement('a');
                                                link.download = 'ceo-2024-wrapped.png';
                                                link.href = canvas.toDataURL('image/png', 1.0);
                                                link.click();
                                            }}>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{ flexShrink: 0 }}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                                                Download for Stories
                                            </button>
                                            <button className="btn" onClick={() => setWrappedSlide(0)}>Watch again</button>
                                        </>
                                    )}
                                </div>
                            </div>

                            <div className="wrapped-right">
                                <div className="wrapped-fragments">
                                    {(() => {
                                        const fragments = [
                                            { text: `${wrappedData.contractsReviewed} scanned`, highlight: true },
                                            { text: `$${(wrappedData.moneySaved/1000).toFixed(0)}K saved`, highlight: true },
                                            { text: 'Masters: 100%', highlight: false },
                                            { text: `${wrappedData.benchmarksChecked} checks`, highlight: false },
                                            { text: '+34% vs offer', highlight: true },
                                            { text: 'No perpetuity', highlight: false },
                                            { text: `Top ${wrappedData.percentile}%`, highlight: true },
                                            { text: '3yr term', highlight: false },
                                            { text: 'Full audit rights', highlight: false },
                                            { text: `$${wrappedData.topWinAmount.toLocaleString()} sync`, highlight: true },
                                        ];
                                        return fragments.map((f, i) => (
                                            <div key={i} className={`wrapped-fragment ${f.highlight ? 'highlight' : ''}`}>{f.text}</div>
                                        ));
                                    })()}
                                </div>
                                <div className="wrapped-stat">
                                    {wrappedSlide === 0 && (
                                        <>
                                            <div className="wrapped-stat-value">{wrappedData.year}</div>
                                        </>
                                    )}
                                    {wrappedSlide === 1 && (
                                        <>
                                            <div className="wrapped-stat-value">{wrappedData.contractsReviewed}</div>
                                            <div className="wrapped-stat-label">Contracts</div>
                                        </>
                                    )}
                                    {wrappedSlide === 2 && (
                                        <>
                                            <div className="wrapped-stat-value">{wrappedData.dealsDodged}</div>
                                            <div className="wrapped-stat-label">Bad deals avoided</div>
                                        </>
                                    )}
                                    {wrappedSlide === 3 && (
                                        <>
                                            <div className="wrapped-stat-value">${(wrappedData.moneySaved / 1000).toFixed(0)}K</div>
                                            <div className="wrapped-stat-label">Saved</div>
                                        </>
                                    )}
                                    {wrappedSlide === 4 && (
                                        <>
                                            <div className="wrapped-stat-value">+{wrappedData.rateImprovement}%</div>
                                            <div className="wrapped-stat-label">Above market</div>
                                        </>
                                    )}
                                    {wrappedSlide === 5 && (
                                        <>
                                            <div className="wrapped-stat-value">{wrappedData.benchmarksChecked}</div>
                                            <div className="wrapped-stat-label">Comparisons</div>
                                        </>
                                    )}
                                    {wrappedSlide === 6 && (
                                        <>
                                            <div className="wrapped-stat-value">Top {wrappedData.percentile}%</div>
                                            <div className="wrapped-stat-label">Of artists at your level</div>
                                        </>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Trust footer */}
                    <footer style={{ marginTop: '48px', paddingTop: '24px', borderTop: '1px solid var(--border)', display: 'flex', justifyContent: 'center', gap: '24px', fontSize: '11px', color: 'var(--text-tertiary)' }}>
                        <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                            All data anonymized
                        </span>
                        <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                            Never sold
                        </span>
                        <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            10,000+ artists
                        </span>
                    </footer>

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
